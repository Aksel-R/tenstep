
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- NProgress -->
    <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/css/custom1.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:100,200,400,500,600" rel="stylesheet" type="text/css">
   <!-- Compiled and minified CSS -->

<style>
@keyframes toggle {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
   
.card-title{​​​​​​​
  text-align: center;
  font-size:19px;
}​​​​​​​

.card-text{​​​​​​​
    color: #424242;
    text-align: center;
     font-size:15px;
        }​​​​​​​

.card-header {​​​​​​​
    padding: 0.5rem ;
    background-color: white;    
}​​​​​​​

.card .card-body {​​​​​​​
       padding: 0rem 0rem 0.7rem 0rem;
        text-align: center;       
}​​​​​​​

.card{​​​​​​​
  box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5);
  min-height:100px;
  background-color: #fafffa;
}​​​​​​​


div#suiteBarButtons {
    display: none;
}


   #headercolor{
    background:#21429b;
    padding:10px;
    margin: 0 0 10px 0;
    text-align:right;
    border-radius : 10px;
  }

    #headercolor span{
    float: left;
    padding-top: 10px;
  }

.smallRisks {
    font-size: 210%;
    float: left;
    font-weight: bold;
    color : white;
    padding-top: 4px;
  }





  #TableauEntete th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: left;
    background-color: #0072c6;
    color: white;
    //font-size: 10px;
  }

#TableauEntete
{
   border-radius: 1em;
  overflow: hidden;
}

#TableauEntete td
{
 text-align:left;
}

tbody#tableauxtbody {
            font-size: 12px;
        }



        #tableaux th {
            background-color: #f39d9d;
            border: 1px solid #fff;
            color: white;
        }

        #tableaux td{
            border: 1px solid #ddd;
        }

            #tableaux tr>*:nth-child(7) {
            text-align: center;
        }

        #tableaux tr>*:nth-child(8) {
            text-align: center;
        }

        #tableaux tr>*:nth-child(9) {
            text-align: center;
        }

        #tableaux tr>*:nth-child(10) {
            text-align: center;
        }


        #mylist1 {

             background-position: 10px 10px;
            background-repeat: no-repeat;
            width: 15%;
            font-size: 13px;
            padding: 12px 20px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;

            
        }

        #mylist2,#mylist0 {
           background-position: 10px 10px;
            background-repeat: no-repeat;
            width: 15%;
            font-size: 13px;
            padding: 12px 20px 12px 15px;
            border: 1px solid #ddd;
            margin-left: 50px;
            border-radius: 5px;
        }

        #mylist3 {
            background-position: 10px 10px;
            background-repeat: no-repeat;
            width: 18%;
            font-size: 13px;
            padding: 12px 20px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

       /* #mylist4 {
            background-position: 10px 10px;
            background-repeat: no-repeat;
            width: 18%;
            font-size: 13px;
            padding: 12px 20px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }*/


  .ms-rtestate-field h1, h1.ms-rteElement-H1, .ms-rtestate-field h2, h2.ms-rteElement-H2 {
    line-height: 1.4;
    color: #000;
}

option:empty
{
 display:none;
}
.ms-core-pageTitle 
{
      font-size: 2.77em;
      white-space: nowrap;
      display: none;
}



.ms-quicklaunchouter.ms-core-sideNavBox-removeLeftMargin {
    display: none;
}


span.ms-cui-tt-span {
    display: none;
}


a#ctl00_PageStateActionButton {
    display: none;
}


.spinner-border {
  text-align: center;
}



button {
  margin: 40px;
  padding: 5px 20px;
  cursor: pointer;
}

@keyframes rotate {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.main-section{
  width: 83%;
  float:right;
  text-align: center;
 
}
.dashbord{
  width:19%;
  display: inline-block;
  background-color:#34495E;
  color:#fff;
  margin-top: 25px; 
}
.icon-section i{
  font-size: 23px;
  padding:7px;
  border:1px solid #fff;
  border-radius:50%;
  margin-top:-15px;
  margin-bottom: 4px;
  background-color:#34495E;
}
.icon-section p{
  margin:0px;
  font-size: 20px;
  padding-bottom: 10px;
}
.detail-section{
  background-color: #2F4254;
  padding: 5px 0px;
}
.dashbord .detail-section:hover{
  background-color: #5a5a5a;
  cursor: pointer;
}
.detail-section a{
  color:#fff;
  text-decoration: none;
}
.dashbord-green .icon-section,.dashbord-green .icon-section i{
  background-color: #16A085;
}
.dashbord-green .detail-section{
  background-color: #149077;
}
.dashbord-orange .icon-section,.dashbord-orange .icon-section i{
  background-color: #F39C12;
}
.dashbord-orange .detail-section{
  background-color: #DA8C10;
}
.dashbord-blue .icon-section,.dashbord-blue .icon-section i{
  background-color: #2980B9;
}
.dashbord-blue .detail-section{
  background-color:#2573A6;
}
.dashbord-red .icon-section,.dashbord-red .icon-section i{
  background-color:#E74C3C;
}
.dashbord-red .detail-section{
  background-color:#CF4436;
}
.dashbord-skyblue .icon-section,.dashbord-skyblue .icon-section i{
  background-color:#8E44AD;
}
.dashbord-skyblue .detail-section{
  background-color:#803D9B;
}

#msTableav {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    border-radius: 1em;
    width: 100%;  }

  #msTableav td, #msTableav th {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
    font-size: 12px;
  }

  #msTableav tr:nth-child(even){background-color: #f2f2f2;}

  #msTableav tr:hover {background-color: #ddd;}

  #msTableav th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: center;
    background-color: #f7b32f;
    color: white;
    font-size: 14px;
  }
  
  #msTableer {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    border-radius: 1em;
    width: 100%;  }

  #msTableer td, #msTableer th {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
    font-size: 12px;
  }

  #msTableer tr:nth-child(even){background-color: #f2f2f2;}

  #msTableer tr:hover {background-color: #ddd;}

  #msTableer th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: center;
    background-color: #f7b32f;
    color: white;
    font-size: 14px;
  }

#msTable {
    font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
    border-collapse: collapse;
    width: 100%;  
    border-radius: 1em;
    font-size: 14px;
  }

  #msTable td, #msTable th {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: center;
    font-size: 12px;
  }

  #msTable tr:nth-child(even){background-color: #f2f2f2;}

  #msTable tr:hover {background-color: #ddd;}

  #msTable th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: center;
    background-color: #f7b32f;
    color: white;
    font-size: 14px;

  }

#overlay {
  background: #ffffff;
  color: #666666;
  position: fixed;
  height: 100%;
  width: 100%;
  z-index: 5000;
  top: 0;
  left: 0;
  float: left;
  text-align: center;
  padding-top: 25%;
  opacity: .80;
}
.spinner {
    margin: 0 auto;
    height: 64px;
    width: 64px;
    animation: rotate 0.8s infinite linear;
    border: 5px solid #0072c6;
    border-right-color: transparent;
    border-radius: 50%;
}
@keyframes rotate {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
.spinner-border {
  text-align: center;
}

</style>

  </head>

<div id="overlay">
    <div class="spinner"></div>
    <br />
    Please Wait A Moment...
</div>
    <div id="headercolor">
        <div>
            <small class="smallRisks">
                PORTEFEUILLE DES PROJETS
            </small>
        </div>
        <div>
            <!-- <select class="mdb-select md-form" style="color:black; font-weight:bold;" id="mylist3"
                onchange="">
                <option value="">Exercice</option>
                <option value="2022">2022</option>
                <option value="2023">2023</option>
            </select>-->
            <select class="mdb-select md-form" style="color:black; font-weight:bold;" id="mylist0"
                onchange="remplirPortefeuilleSelect();filtrePortefeuille();" >
                <option value="">EXERCICE</option>
            </select>
            <select class="mdb-select md-form" disabled style="color:black; font-weight:bold;" id="mylist2"
                onchange="filtrePortefeuille();loadSelectProgramme()">
                <option value="">PORTEFEUILLE PROJET</option>
            </select>

             <select class="mdb-select md-form" style="color:black; font-weight:bold;" id="mylist1"
                onchange="filtreProgramme();loadSelectProprietaireProjet()" disabled>
                <option value="">PROGRAMME</option>
            </select>

            <!--<select class="mdb-select md-form" style="color:black; font-weight:bold;" id="mylist3"
                onchange="filtreProrietaireProjet();" disabled>
                <option value="">PROPRIÉTAIRE DE PROJET</option>
            </select> -->

        </div>
    </div>
<div class="col-sm-12 justify-content-between" style="padding-right: 0px;">
    <div class="main-section">
        
        </br>
  <div class="col-sm-12">
    <div class="x_panel" id="xpanelmodified"
        style="width:100%; box-shadow: 0px 4px 8px 0px rgb(0 0 0 / 50%);border-radius: 5px;">
        <div class="x_title">
         <h4 style="color: black;margin: 0px;"><b>PROGRAMME</b></h4>
            <div class="clearfix"></div>
        </div>
        <div id="projchartDiv">
         <canvas id="projchart" style="max-height: 550px;display: block;width: 1379px;"></canvas>
         </div>
    </div>
</div>
        <div class="col-md-6 col-sm-3 col-xs-12">
            <div class="x_panel" style="width:100%; box-shadow: 0px 4px 8px 0px rgb(0 0 0 / 50%);border-radius: 5px;">
                <div class="x_title">
                    <h4 id="PortefeuilleAff" style="color: black;margin: 0px;"><b>NOMBRE DES PROJETS PAR PORTEFEUILLE</b></h4>
                    <h4 id="ProgrammeAff" style="color: black;margin: 0px;"><b>NOMBRE DE PROJET PAR PROGRAMME</b></h4>
                    <h4 id="StatutAff" style="color: black;margin: 0px;"><b>NOMBRE DE PROJET PAR STATUT</b></h4>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div>
                     <div id="barslineDiv">
                        <canvas id="barsline"></canvas>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-3 col-xs-12">
            <div class="x_panel" style="width:100%; box-shadow: 0px 4px 8px 0px rgb(0 0 0 / 50%);border-radius: 5px;">
                <div class="x_title">
                    <h4  style="color: black;margin: 0px;"><b>TYPES DES PROJETS DU PORTEFEUILLE</b></h4>
                    
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div>
                    <div id="sous_portefeuilleDiv">
                        <canvas id="sous_portefeuille"></canvas>
                    </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-12">
            <h4 id="ertabtit" style="color: black"><b>Détails des projets</b></h4>
            <div class="form-group" style="    float: right;">
                                <!--        Show Numbers Of Rows        -->
                                <select class="form-control" name="state" id="maxRows">
                                    <option value="5000">Afficher toutes les lignes</option>
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="70">70</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
            <table class="table table-striped  jambo_table bulk_action no-footer-border" id="tableaux">
                <thead>
                    <tr>
                                        <th style="border-radius:10px 0px 0px 0px; width: 25%;">NOM DE PROJET</th>
                                        <th></th>
                                        <th style="width: 15%;">PROGRAMME</th>
                                        <th style="width: 15%;">TYPE DE PROJET</th>
                                        <th style="width: 15%;">PROPRIÉTAIRE DU PROJET</th>
                                        <th style="width: 10%;">DATE DE DÉBUT</th>
                                        <th style="width: 10%;">DATE FIN</th>
                                        <th>COÛT</th>
                                        <th>Coût consommé</th>
                                        <th>Coût restant</th>
                                      <!--  <th style="width: 5%;">COÛT SANTÉ</th>
                                        <th style="width: 6%;">TRAVAIL SANTÉ</th>
                                        <th style="width: 5%;">SANTÉ DE CALENDRIER</th>
                                        <th style="width: 7%;">SANTÉ DE PROJET</th> -->
                                        <th style="border-radius:0px 10px 0px 0px; width:10%;">% ACHEVÉ</th>
                                    </tr>
                </thead>
                <tbody></tbody>
            </table>
                <div class='pagination-container'>
                <nav>
                    <ul class="pagination">

                        <li data-page="prev">
                            <span>
                                <a href="#" class="previous round" style="color:white;">&#8249;</a> <span
                                    class="sr-only" style="color:white;">(current)
                                </span></span>
                        </li>
                        <!-- Here the JS Function Will Add the Rows -->
                        <li data-page="next" id="prev">
                            <span> <a href="#" class="next round" style="color:white;">&#8250;</a> <span class="sr-only"
                                    style="color:white;">(current)</span></span>
                        </li>
                    </ul>
                </nav>
                </div>
        </div>
        
        
    </div>

    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #c9dcc9;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon">
                <img src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/e-learning.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Nombre de portefeuilles</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="portefeuillecount" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #c9dcc9;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon">
                <img src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/e-learning.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Nombre de programmes</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="pgcount" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #c9dcc9;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon">
                <img src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/e-learning.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Nombre de projets</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="prcount" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/calculator.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Coût</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="prcost" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/calculator.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Coût consommée</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="sommeCoutReel" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>

    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/calculator.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Coût restant</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="couRestantPortefeuilleProProj" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>

    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/budget.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Variance de coût</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="cvariance" style="font-size: x-large; text-align: center;color: black;">
                </p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/work.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Travail</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="prwork" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/watch.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Variance de travail</h6>
            </div>
            <div class="card-body">

                <p class="card-text" id="wrvariance" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%;  box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/risk.png'
                        class='img-rounded' alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Risques</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="actRisk" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>
        </div>
    </div>
    <div class="card mb-3"
        style="max-width: 17%; box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5); min-height:80px; border-radius: 5px; background-color: #fafffa;">
        <div class="card-header">
            <div class="col-sm-3" style="padding-top: 10px">
                <span class="card-widget__icon"><img
                        src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/project.png' class='img-rounded'
                        alt='Cinque Terre' width='45px' height='45px'></span>
            </div>
            <div class="col">
                <h6 class="card-title" style="color: black;text-align: center;padding-top: 10px">Problèmes</h6>
            </div>
            <div class="card-body">
                <p class="card-text" id="actIssue" style="font-size: x-large; text-align: center;color: black;"></p>
            </div>

        </div>
    </div>

    <script type="text/javascript" src="https://momentjs.com/downloads/moment-with-locales.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/jquery3.4.1.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/custom.min.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/emn178/chartjs-plugin-labels/src/chartjs-plugin-labels.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/nprogress.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/PortefeuilleFiltre.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/ProgrammeSelect.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/ProgrammeFiltre.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/ProprietaireProjetSelect.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/ProprietaireProjetFiltre.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/MainFilter.js"></script>
    <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/javascript/PortefeuilleSelect.js"></script>
 
 <script type="text/javascript">


$('#ProgrammeAff').hide();
$('#StatutAff').hide();
jQuery(document).ready(function() {
    jQuery('#overlay').fadeOut(3000);
});



        //-----------------------------------------------------------------------------------------------------------------------------
        //Premier affichage par défaut


        function conToMill(num) {
            if (num == 0) {
                return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1).toFixed(2)) : Math.sign(num) * Math.abs(num)
            }
            if (num < 1000000 && num > 999) {
                return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1000).toFixed(2)) + 'K' : Math.sign(num) * Math.abs(num)
            }
            if (num < -999 && num > -1000000) {
                return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1000).toFixed(2)) + 'K' : Math.sign(num) * Math.abs(num)
            }
            if (num < 0 && num > -1000) {
                return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1).toFixed(2)) : Math.sign(num) * Math.abs(num)
            }
            if (num > 0 && num < 1000) {
                return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1).toFixed(2)) : Math.sign(num) * Math.abs(num)
            }
            if (num > 999999) {
                return Math.abs(num) > 999999 ? Math.sign(num) * ((Math.abs(num) / 1000000).toFixed(2)) + 'M' : Math.sign(num) * Math.abs(num)
            }
            if (num < -999999) {
                return Math.abs(num) > 999999 ? Math.sign(num) * ((Math.abs(num) / 1000000).toFixed(2)) + 'M' : Math.sign(num) * Math.abs(num)
            }

        }


        //Load All Data in Select Lists

function loadMain(){
    //Fonction qui permet d'afficher les list des Projets
        

        function AnneeSelectFilter() {
          moment.locale('fr');
          var arrMois=[];
          var arrMois1=[];
          var moisActuel= moment().format('YYYY-MM-DD');
          var dateCount= moment([2018, 1, 1]).format('YYYY-MM-DD');
          dateCount=moment(dateCount).add(-1, 'months');
          do {
            arrMois.push(moment(dateCount).format('YYYY'));
            arrMois1.push(moment(dateCount).format('YYYY-MM-DD'));
            dateCount=moment(dateCount).add(1, 'years');
          } while (moment(dateCount).isSameOrBefore(moisActuel));
          
          var finalArrMois=arrMois.reverse();
          var finalArrMois1=arrMois1.reverse();
          console.log("finalArrMois= "+finalArrMois);
          for (var i = 0; i < finalArrMois.length; i++) {
            $('#mylist0').append($('<option>',
            {
              text : finalArrMois[i],
              value:finalArrMois1[i]
            })); 
            var opt = {};
            $("#mylist0 > option").each(function () {
              if(opt[$(this).text()]) {
                  $(this).remove();
              } else {
                  opt[$(this).text()] = $(this).val();
              }
            });
          }
        }
        AnneeSelectFilter();
        //_spBodyOnLoadFunctionNames.push("LoadProjectTypeName");



        //Fonction qui permet d'afficher liste de Projet 
/*        var responsePhase = responsePhase || [];
        var urlPhase = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectPhase,ProjectId";
        function LoadProjectGovernant() {
            $.ajax({
                url: urlPhase,

                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responsePhase = responsePhase.concat(data.d.results);
                    if (data.d.__next) {
                        urlPhase = data.d.__next;
                        LoadProjectGovernant();
                    }

                    $.each(responsePhase, function (key, value) {
                        var nomprojet = value.ProjectPhase;
                        var projetId = value.ProjectId;
                        if (nomprojet != "") {
                            var prName = nomprojet;


                            $('#mylist4').append($('<option>',
                                {
                                    text: prName
                                }));
                        }
                        var opt = {};
                        $("#mylist4 > option").each(function () {
                            if (opt[$(this).text()]) {
                                $(this).remove();
                            } else {
                                opt[$(this).text()] = $(this).val();
                            }
                        });
                    });
                }
            });
        }
        LoadProjectGovernant();*/
        //_spBodyOnLoadFunctionNames.push("LoadProjectGovernant");






        //Fonction qui permet d'afficher liste de Projet  
        
        // _spBodyOnLoadFunctionNames.push("LoadProjectOwner");



        //Fonction qui permet d'afficher les list des risks
        
        // _spBodyOnLoadFunctionNames.push("LoadProgramme");



        //Load Number Of All Issues
        var responseAllIssues = responseAllIssues || [];
        var urlAllIssues = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Issues?$select=Title"
        function NumberOfAllIssues() {
            var nbreIssue = 0;

            $.ajax({
                url: urlAllIssues,
                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseAllIssues = responseAllIssues.concat(data.d.results);
                    if (data.d.__next) {
                        urlAllIssues = data.d.__next;
                        NumberOfAllIssues();
                    }

                    $.each(responseAllIssues, function (key, value) {
                        var titreIssue = value.Title;
                        if (titreIssue != null) {
                            nbreIssue++;
                        }

                    });
                    document.getElementById("actIssue").innerHTML = nbreIssue;
                }
            });
        }
        NumberOfAllIssues();
        //_spBodyOnLoadFunctionNames.push("NumberOfAllIssues");



        //Load Number Of All Risks
        var responseAllRsiks = responseAllRsiks || [];
        var urlAllRisks = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Risks?$select=Title"
        function NumberOfAllRisks() {
            var nbreRisks = 0;

            $.ajax({
                url: urlAllRisks,
                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseAllRsiks = responseAllRsiks.concat(data.d.results);
                    if (data.d.__next) {
                        urlAllRisks = data.d.__next;
                        NumberOfAllRisks();
                    }

                    $.each(responseAllRsiks, function (key, value) {
                        var titreRisks = value.Title;
                        if (titreRisks != null) {
                            nbreRisks++;
                        }

                    });
                    document.getElementById("actRisk").innerHTML = nbreRisks;
                }
            });
        }
        NumberOfAllRisks();
        // _spBodyOnLoadFunctionNames.push("NumberOfAllRisks");


        //Load Number Of All Project
        var responseNumberOfProjects = responseNumberOfProjects || [];
        var urlNumberOfProjects = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectName,Types_de_Projet";
        function LoadAllNumberProject() {
            var nbre = 0;
            var nbrePG = 0;
            var nbrePR = 0;

            $.ajax({
                url: urlNumberOfProjects,
                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseNumberOfProjects = responseNumberOfProjects.concat(data.d.results);
                    if (data.d.__next) {
                        urlNumberOfProjects = data.d.__next;
                        LoadAllNumberProject();
                    }

                    $.each(responseNumberOfProjects, function (key, value) {
                        var nomProjet = value.ProjectName;
                        var projectType = value.Types_de_Projet;

                        if(projectType =='Page_Maitre'){
                        if (nomProjet != null) {
                            nbre++;
                            }
                        }

                        if(projectType =='Programme'){
                            if (nomProjet != null) {
                                nbrePG++;
                            }
                        }

                        if(projectType =='Portefeuille'){
                            if (nomProjet != null) {
                                nbrePR++;
                            }
                        }

                    });
                    document.getElementById("portefeuillecount").innerHTML = nbrePR;
                    document.getElementById("prcount").innerHTML = nbre;
                    document.getElementById("pgcount").innerHTML = nbrePG;
                }
            });
        }
        LoadAllNumberProject();
        // _spBodyOnLoadFunctionNames.push("LoadAllNumberProject");






        var responseDataSum = responseDataSum || [];
        var urlDataSum = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectCost,ProjectActualCost,ProjectCostVariance,ProjectWork,ProjectWorkVariance&$filter=Types_de_Projet eq 'Portefeuille'";

        function loadDataSum() {
            var projCost = 0;
            var projcostvariance = 0;
            var projWork = 0;
            var pworkvariance = 0;
            var sommeCoutReel = 0;
            var sommeCoutRestant = 0;

            $.ajax({
                url: urlDataSum,
                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseDataSum = responseDataSum.concat(data.d.results);
                    if (data.d.__next) {
                        urlDataSum = data.d.__next;
                        loadDataSum();
                    }

                    $.each(responseDataSum, function (key, value) {
                        var pCost = parseInt(value.ProjectCost);
                        var pcostVar = parseInt(value.ProjectCostVariance);
                        var pwork = parseInt(value.ProjectWork);
                        var pwvariance = parseInt(value.ProjectWorkVariance);


                        projCost = projCost + pCost;
                        projcostvariance = projcostvariance + pcostVar;
                        projWork = projWork + pwork;
                        pworkvariance = pworkvariance + pwvariance;

                        var coutReel=parseFloat(value.ProjectActualCost).toFixed(0);
                        //sommeCoutPlan=parseFloat(parseFloat(sommeCoutPlan)+parseFloat(coutPlan)).toFixed(0);
                        sommeCoutReel=parseFloat(parseFloat(sommeCoutReel)+parseFloat(coutReel)).toFixed(0);

                        sommeCoutRestant = parseFloat(projCost).toFixed(0) - parseFloat(sommeCoutReel).toFixed(0);


                    });


                    document.getElementById("prcost").innerHTML = conToMill(projCost);
                    document.getElementById("sommeCoutReel").innerHTML = conToMill(sommeCoutReel);
                    document.getElementById("couRestantPortefeuilleProProj").innerHTML = conToMill(sommeCoutRestant);

                    document.getElementById("cvariance").innerHTML = conToMill(projcostvariance);
                    document.getElementById("prwork").innerHTML = conToMill(projWork);
                    document.getElementById("wrvariance").innerHTML = conToMill(pworkvariance);

                    

                }
            });
        }
        loadDataSum();
        //_spBodyOnLoadFunctionNames.push("loadDataSum"); 


        //Load BarChart for GOVERNANCE
        var responseGovernancePhase = responseGovernancePhase || [];
        var urlGovernancePhase = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=Programme,ProjectPercentCompleted&$filter=Types_de_Projet eq 'Programme'"
        function LoadBarGovernancePhase() {
            $.ajax({
                url: urlGovernancePhase,

                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseGovernancePhase = responseGovernancePhase.concat(data.d.results);
                    if (data.d.__next) {
                        urlGovernancePhase = data.d.__next;
                        LoadBarGovernancePhase();
                    }
                    var itermeidiaryObject = {};
                     var labels=[];
                    var pievalues=[];
                    $.each(responseGovernancePhase, function (key, value) {

                        var epn = value.Programme;
                        var ach = value.ProjectPercentCompleted;
             
                        labels.push(epn);
                        pievalues.push(ach);
                       
                    });

                    


                   

                    var ctx1 = document.getElementById("projchart").getContext('2d');

                    if (window.mychartBar != undefined) {
                        window.mychartBar.destroy();
                    }

                    window.mychartBar = new Chart(ctx1, {
                        type: 'horizontalBar',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: pievalues,
                                backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850",
                                    "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850",
                                    "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850",
                                    "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850",
                                    "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850",
                                    "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850", "#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"]
                            }]
                        },
                        options: {

                            scales: {

                                xAxes: [{
                                    ticks: {
                                        beginAtZero: true,
                                        min: 0,
                                        max: 100,
                                        callback: function (value) { return value + "%" }
                                    },
                                    scaleLabel: {
                                      display: true,
                                      fontSize: 15,
                                      labelString: "Pourcentage achevé"
                                    }
                                }],
                                yAxes: [{
                                    ticks: {
                                      beginAtZero: true
                                    },
                                    scaleLabel: {
                                          display: true,
                                          fontSize: 15,
                                          labelString: "Programmes"
                                        }
                                  }]
                            },
                            responsive: true,


                            legend: { display: false },
                            plugins: {
                                labels: {
                                    render: 'label',
                                    fontColor: '#000',
                                    position: 'outside'
                                }
                            },


                        }
                    });


                }
            });
        }
        LoadBarGovernancePhase();
        //  _spBodyOnLoadFunctionNames.push("LoadBarGovernancePhase");



        var colors = ["#455c73", "#3498db", "#26b99a", "#7FDBFF", "#B10DC9", "#FFDC00", "#001f3f", "#39CCCC", "#01FF70", "#85144b", "#F012BE", "#3D9970", "#111111", "#AAAAAA"];


        //Load Graph For ProjectPortfolio
        var responsePhaseChart = responsePhaseChart || [];
        var urlPhaseChart = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=EnterpriseProjectTypeName&$filter=Types_de_Projet ne 'Programme' and Types_de_Projet ne 'Portefeuille'";
        function LoadProjectType() {
            $.ajax({
                url: urlPhaseChart,


                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responsePhaseChart = responsePhaseChart.concat(data.d.results);
                    if (data.d.__next) {
                        urlPhaseChart = data.d.__next;
                        LoadProjectType();
                    }
                    var itermeidiaryObject = {};
                    $.each(responsePhaseChart, function (key, value) {

                        var epn = value.EnterpriseProjectTypeName;
                        var som = 0;
                        if (epn != null) {
                            itermeidiaryObject[epn] = ++itermeidiaryObject[epn] || 1;
                        }
                        var somme = som;
                    });

                    var finalObject = Object.keys(itermeidiaryObject).map(function (key) {
                        return {
                            label: key,
                            y: itermeidiaryObject[key]
                        }
                    });

                    var pievalues = finalObject.map(function (value, index) {
                        return value.y;
                    });

                    var labels = finalObject.map(function (value, index) {
                        return value.label;
                    });

                    var colorscheme = colors.slice(0, labels.length);


                    var ctx2 = document.getElementById("barsline").getContext('2d');
                    if (window.echartdonut != undefined) {
                        window.echartdonut.destroy();
                    }

                    window.echartdonut = new Chart(ctx2, {
                        type: 'doughnut',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: pievalues,
                                backgroundColor: colorscheme
                            }]
                        },
                        options: {
                            legend: { display: true },
                            responsive: true,
                            plugins: {
                                labels: [
                                    {
                                        render: 'label',
                                        fontColor: '#000',
                                        position: 'outside',
                                        fontSize: 11
                                    },
                                    {
                                        fontColor: '#fff',
                                        render: 'value',
                                        fontSize: 12
                                    }
                                ]
                            }
                        }
                    });


                }
            });
        }
        LoadProjectType();
        //_spBodyOnLoadFunctionNames.push("LoadProjectType");          

        var colors = ["#455c73", "#3498db", "#26b99a", "#7FDBFF", "#B10DC9", "#FFDC00", "#001f3f", "#39CCCC", "#01FF70", "#85144b", "#F012BE", "#3D9970", "#111111", "#AAAAAA"];

         var response_SousPortefeuille = response_SousPortefeuille || [];
        var urlSous_Portefeuille = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=Types_des_projets";
        function LoadSous_Portefeuille() {
            $.ajax({
                url: urlSous_Portefeuille,


                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    response_SousPortefeuille = response_SousPortefeuille.concat(data.d.results);
                    if (data.d.__next) {
                        urlSous_Portefeuille = data.d.__next;
                        LoadSous_Portefeuille();
                    }
                    var itermeidiaryObject1 = {};
                    $.each(response_SousPortefeuille, function (key, value) {

                        var epn = value.Types_des_projets;
                        var som = 0;
                        if (epn != null) {
                            itermeidiaryObject1[epn] = ++itermeidiaryObject1[epn] || 1;
                        }
                        var somme = som;
                    });

                    var finalObject1 = Object.keys(itermeidiaryObject1).map(function (key) {
                        return {
                            label: key,
                            y: itermeidiaryObject1[key]
                        }
                    });

                    var pievalues = finalObject1.map(function (value, index) {
                        return value.y;
                    });

                    var labels = finalObject1.map(function (value, index) {
                        return value.label;
                    });

                    var colorscheme1 = colors.slice(0, labels.length);


                    var ctx3 = document.getElementById("sous_portefeuille").getContext('2d');
                    if (window.echartdonut1 != undefined) {
                        window.echartdonut1.destroy();
                    }

                    window.echartdonut1 = new Chart(ctx3, {
                        type: 'doughnut',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: pievalues,
                                backgroundColor: colorscheme1
                            }]
                        },
                        options: {
                            legend: { display: false },
                            responsive: true,
                            plugins: {
                                labels: [
                                    {
                                        render: 'label',
                                        fontColor: '#000',
                                        position: 'outside',
                                        fontSize: 11
                                    },
                                    {
                                        fontColor: '#fff',
                                        render: 'value',
                                        fontSize: 12
                                    }
                                ]
                            }
                        }
                    });


                }
            });
        }
        LoadSous_Portefeuille();


        //Load All Value in table 

        //Table Project 
        var responseTabProj = responseTabProj || [];
        var urlTabProj = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectWorkspaceInternalUrl,ProjectOwnerName,Programme,Types_des_projets,ProjectId,ProjectDuration,ProjectName,ProjectStartDate,ProjectFinishDate,ProjectPercentCompleted,ProjectActualCost,ProjectActualWork,ProjectWorkVariance,ProjectWork,ProjectCost&$filter=Types_de_Projet eq 'Page_Maitre'";
        function LoadTableProjects() {
            var sommeCoutReels = 0;
            var sommecoutRestant =0;
            $.ajax({
                url: urlTabProj,

                method: "GET",
                dataType: "json",
                headers: { Accept: "application/json;odata=verbose" },
                success: function (data) {
                    responseTabProj = responseTabProj.concat(data.d.results);
                    var c=0;
                    if (data.d.__next) {
                        c++;
                        urlTabProj = data.d.__next;
                        LoadTableProjects();
                    }

                    tr1 = tableaux.getElementsByTagName("tr");
                    if(tr1.length>0){
                    $('#tableaux tbody').empty();
                    }


                    var arrayOwnerName = [];
                    var arrayProgramme = [];
                    var arrayTypeProjet = [];
                    var arrayProjectId = [];



                    $.each(responseTabProj, function (key, value) {

                        var projetId = value.ProjectId;
                        var Types_des_projets = value.Types_des_projets;

                        if(Types_des_projets == null)
                        {
                            Types_des_projets = "Pas de Type de projet"
                        }

                        var Prog = "";
                        var Sous_Prog = "";
                        if (value.Programme == null) {
                            Prog = "Pas de programme assigné";
                        }
                        else{
                            Prog = value.Programme;
                        }
                         if (value.Sous_Programme == null) {
                            Sous_Prog = "Pas de sous programme assigné";
                        }
                        else{
                            Sous_Prog = value.Sous_Programme;
                        }
                        
                        var nomProjet = value.ProjectName;
                        var pOwner = value.ProjectOwnerName;
                        var projStartDate = value.ProjectStartDate;
                        var projfinishdate = value.ProjectFinishDate;
                        var projCost = parseFloat(value.ProjectCost).toFixed(3);
                        var prPercentCpl = parseFloat(value.ProjectPercentCompleted).toFixed(0);
                        var linkProjectSite = value.ProjectWorkspaceInternalUrl;
                        moment.locale('fr');
                        if (projStartDate != null) {
                            var projStartDate = moment(projStartDate).format('L');
                        }

                        if (projfinishdate != null) {
                            var projfinishdate = moment(projfinishdate).format('L');
                        }

                        var pType = value.EnterpriseProjectTypeName;
                        var drProject = value.Programme;
                        var projetPhase = value.ProjectPhase;


                        if ((projetPhase == null) || (projetPhase.toString() == "") || (projetPhase.toString() == "null")) {
                            projetPhase = "not assigned";
                        }

                        var coutReel=parseFloat(value.ProjectActualCost).toFixed(0);
                        sommeCoutReels=parseFloat(parseFloat(sommeCoutReels)+parseFloat(coutReel)).toFixed(0);

                        sommecoutRestant = parseFloat(projCost - sommeCoutReels).toFixed(0); 

                        
                        var pCost = parseInt(value.ProjectCost);
                        var pcostVar = parseInt(value.ProjectCostVariance);
                        var pwork = parseInt(value.ProjectWork);
                        var pwvariance = parseInt(value.ProjectWorkVariance);






                        /*$('#tableaux tbody tr').each(function() {
                                        var abc = $(this).children('td').eq(7).html();
                                        var abc1 = $(this).children('td').eq(8).html();
                                        var abc2 = $(this).children('td').eq(9).html();
                                        
                                            if(abc == 0) {
                                                $(this).children('td').eq(7).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                            if(abc1 == 0) {
                                                $(this).children('td').eq(8).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                            if(abc2 == 0) {
                                                $(this).children('td').eq(9).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                        
                                    });*/





                        var tr;
                        tr = $("<tr class='even pointer'>");
                        tr.append("<td>" + nomProjet + "</td>");//0
                        tr.append("<td><a href=https://m365x56447071.sharepoint.com/sites/BIAT/project%20detail%20pages/schedule.aspx?projuid="+projetId+"&ret=0 id='redirectLink' target='_blank'><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/portFolioDashboard/img/link.png' class='img-rounded' alt='Cinque Terre' width='20px' height='20px'></a></td>");//1
                        tr.append("<td>" + Prog + "</td>"); //2
                        tr.append("<td>" + Types_des_projets + "</td>"); //2
                        tr.append("<td>" + pOwner + "</td>"); //2
                        tr.append("<td>" + projStartDate + "</td>"); //3
                        tr.append("<td>" + projfinishdate + "</td>"); //4
                        tr.append("<td>" + conToMill(projCost) + " </td>");//5
                        tr.append("<td>" + conToMill(sommeCoutReels) + " </td>");//5
                        tr.append("<td>" + conToMill(sommecoutRestant) + " </td>");//5


                        tr.append('<td style="text-align:center;font-size: medium;">'+prPercentCpl+'%<progress id="" max="100" value="'+prPercentCpl+'" style="width: 100%; height:2vh;"></progress></td>'); //10
                        tr.append("<td style='display:none;'>" + projetPhase + " </td>"); //11
                        tr.append("<td style='display:none;'>" + pType + " </td>"); //12
                        tr.append("<td style='display:none;'>" + drProject + " </td>"); //13
                        tr.append("<td style='display:none;'>" + pOwner + " </td>"); //14
                        tr.append("<td style='display:none;'>" + pCost + " </td>"); //15
                        tr.append("<td style='display:none;'>" + pcostVar + " </td>"); //16
                        tr.append("<td style='display:none;'>" + pwork + " </td>"); //17
                        tr.append("<td style='display:none;'>" + pwvariance + " </td>"); //18
                        tr.append("<td style='display:none;'>" + projetId + " </td>"); //19
                        $('#tableaux').append(tr);




                        //--------------------------------------Coloration Tableau ----------------------------

                      
                                    /*$('#tableaux tr').each(function() {
                                        var abc = $(this).children('td').eq(7).html();
                                        var abc1 = $(this).children('td').eq(8).html();
                                        var abc2 = $(this).children('td').eq(9).html();
                                        
                                            if(abc == 0) {
                                                $(this).children('td').eq(7).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                            if(abc1 == 0) {
                                                $(this).children('td').eq(8).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                            if(abc2 == 0) {
                                                $(this).children('td').eq(9).css('background-color', 'RGBA(255,198,191,0.4)');
                                            }
                                        
                                    });*/
                                    
                        //-------------------------------------------------------------------------------------







                    });
                }
            });

        }
        LoadTableProjects();














        getPagination('#tableaux');

        function getPagination(table) {

            var lastPage = 1;

            $('#maxRows')
                .on('change', function (evt) {
                    //$('.paginationprev').html('');                      // reset pagination

                    lastPage = 1;
                    $('.pagination')
                        .find('li')
                        .slice(1, -1)
                        .remove();
                    var trnum = 0; // reset tr counter
                    var maxRows = parseInt($(this).val()); // get Max Rows from select option

                    if (maxRows == 5000) {
                        $('.pagination').hide();
                    } else {
                        $('.pagination').show();
                    }

                    var totalRows = $(table + ' tbody tr').length; // numbers of rows
                    $(table + ' tr:gt(0)').each(function () {
                        // each TR in  table and not the header
                        trnum++; // Start Counter
                        if (trnum > maxRows) {
                            // if tr number gt maxRows

                            $(this).hide(); // fade it out
                        }
                        if (trnum <= maxRows) {
                            $(this).show();
                        } // else fade in Important in case if it ..
                    }); //  was fade out to fade it in
                    if (totalRows > maxRows) {
                        // if tr total rows gt max rows option
                        var pagenum = Math.ceil(totalRows / maxRows); // ceil total(rows/maxrows) to get ..
                        //  numbers of pages
                        for (var i = 1; i <= pagenum;) {
                            // for each page append pagination li
                            $('.pagination #prev')
                                .before(
                                    '<li data-page="' +
                                    i +
                                    '">\
                                  <span>' +
                                    i++ +
                                    '<span class="sr-only">(current)</span></span>\
                                </li>'
                                )
                                .show();
                        } // end for i
                    } // end if row count > max rows
                    $('.pagination [data-page="1"]').addClass('active'); // add active class to the first li
                    $('.pagination li').on('click', function (evt) {
                        // on click each page
                        evt.stopImmediatePropagation();
                        evt.preventDefault();
                        var pageNum = $(this).attr('data-page'); // get it's number

                        var maxRows = parseInt($('#maxRows').val()); // get Max Rows from select option

                        if (pageNum == 'prev') {
                            if (lastPage == 1) {
                                return;
                            }
                            pageNum = --lastPage;
                        }
                        if (pageNum == 'next') {
                            if (lastPage == $('.pagination li').length - 2) {
                                return;
                            }
                            pageNum = ++lastPage;
                        }

                        lastPage = pageNum;
                        var trIndex = 0; // reset tr counter
                        $('.pagination li').removeClass('active'); // remove active class from all li
                        $('.pagination [data-page="' + lastPage + '"]').addClass('active'); // add active class to the clicked
                        // $(this).addClass('active');                  // add active class to the clicked
                        limitPagging();
                        $(table + ' tr:gt(0)').each(function () {
                            // each tr in table not the header
                            trIndex++; // tr index counter
                            // if tr index gt maxRows*pageNum or lt maxRows*pageNum-maxRows fade if out
                            if (
                                trIndex > maxRows * pageNum ||
                                trIndex <= maxRows * pageNum - maxRows
                            ) {
                                $(this).hide();
                            } else {
                                $(this).show();
                            } //else fade in
                        }); // end of for each tr in table
                    }); // end of on click pagination list
                    limitPagging();
                })
                .val(5000)
                .change();

            // end of on select change

            // END OF PAGINATION
        }

        function limitPagging() {
            // alert($('.pagination li').length)

            if ($('.pagination li').length > 7) {
                if ($('.pagination li.active').attr('data-page') <= 3) {
                    $('.pagination li:gt(5)').hide();
                    $('.pagination li:lt(5)').show();
                    $('.pagination [data-page="next"]').show();
                } if ($('.pagination li.active').attr('data-page') > 3) {
                    $('.pagination li:gt(0)').hide();
                    $('.pagination [data-page="next"]').show();
                    for (let i = (parseInt($('.pagination li.active').attr('data-page')) - 2); i <= (parseInt($('.pagination li.active').attr('data-page')) + 2); i++) {
                        $('.pagination [data-page="' + i + '"]').show();

                    }

                }
            }
        }

        $(function () {
            // Just to append id number for each row
            $('table tr:eq(20)').prepend('<th  style="display:none;"> ID </th>');

            var id = 0;

            $('table tr:gt(20)').each(function () {
                id++;
                $(this).prepend('<td style="display:none;">' + id + '</td>');
            });
        });
}
  loadMain();      
    </script>