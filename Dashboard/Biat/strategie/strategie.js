
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

 <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/bootstrap.min.css" rel="stylesheet">
    <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/bootstrap.css" rel="stylesheet">
    <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/style.css" rel="stylesheet">
<link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/achevement.css" rel="stylesheet">
    <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/dataTables.bootstrap4.min.css" rel="stylesheet">
    <link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/w3.css"  rel="stylesheet">
<link href="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/css/jquery.dataTables.min.css" rel="stylesheet">
    

    <!-- Bootstrap -->
   


  
   <!-- Compiled and minified CSS -->


<style>
element.style {
    fill: #00FF00;
    display: none;
}

.form-control-sm {
    min-height: 30px;
    max-height: 10px;
}

.custom-select-sm {
    
    padding: 0.375rem;
   
    font-size: 100%;
}


.dataTables_length select, .dataTables_filter input{
  border-color: #31752f;
outline: 0;

box-shadow: inset 0 2px 2px rgba(0,0,0,.075), 0 0 8px rgb(49 117 47);

}


text.highcharts-credits {
    display: none;
}
.highcharts-strong {
    font-weight: 100;
}

.highcharts-figure, .highcharts-data-table table {
    width:100%;
    margin: 1em auto;
}

.highcharts-data-table table {
  font-family: Verdana, sans-serif;
  border-collapse: collapse;
  border: 1px solid #EBEBEB;
  margin: 10px auto;
  text-align: center;
  width: 100%;
  max-width: 500px;
}
.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}
.highcharts-data-table th {
  font-weight: 600;
    padding: 0.5em;
}
.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
    padding: 0.5em;
}
.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}
.highcharts-data-table tr:hover {
    background: #f1f7ff;
}


.card-title{
  text-align: center;
  font-size:14px;
}

.card-text{
    color: #424242;
    text-align: center;
     font-size:13px;
    
        }






.card-header {
    padding: 0.1rem ;
   
     

    
}
.card .card-body {
       padding: 0rem 0rem 0.2rem 0rem;
        text-align: center;

        
}
.card{
  box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5);
  height:100px;
  background-color: #fafffa;

}

.ms-rtestate-field h4, h4.ms-rteElement-H4 {
    line-height: 1.6;
    color: #212529;
}




#headercolor {
    background: #21429b;
    background-color: #21429b;
    //background-image: linear-gradient(225deg, #51abed 20%, #0072c6 80%);
    padding: 10px;
    margin: 0 0 10px 0;
    text-align: right;
    border-radius: 15px 15px 0px 0px;
}

    #headercolor span{
    float: left;
    padding-top: 10px;
  }

   #headercolor1{
    background:#21429b;
    //background-image: linear-gradient(225deg, #bbd0df 20%, #46a3e8 80%);
    padding:10px;
    margin: 0 0 10px 0;
    text-align:right;
    box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5);
    margin-bottom: 20px;
  }

    #headercolor1 span{
    float: left;
    padding-top: 10px;
  }


    .smallRisks {
    font-size: 140%;
    float: left;
    font-weight: bold;
    color : white;
  }

   .smallRisks1 {
    font-size: 140%;
    float: left;
    font-weight: bold;
    color : white;
  }

  #tableaux
{
   border-radius: 1em;
  overflow: hidden;
  width:100%;
   
}

   #tableaux th {
    padding-top: 12px;
    padding-bottom: 12px;
    text-align: center;
    background-image: linear-gradient(225deg, #f39d9d 20%, #f18572 80%);
    color: white;
  }
  .table-bordered>tbody>tr>td{
    border: 1px solid #31752f;
}

   #tableaux td, #tableaux th {
    border: 1px solid #ddd;
    padding: 8px;
  }


  #tableaux td{
    text-align:center;
  }
 

  #mylist1 {
    background-position: 10px 10px;
    background-repeat: no-repeat;
    font-size: 16px;
    width: 320px;
    padding: 12px 20px 12px 15px;
    border: 1px solid #ddd;
    margin-left:50px;
    border-radius : 15px 15px 0px 0px;
  }

  #mylist2 {
    background-position: 10px 10px;
    background-repeat: no-repeat;
    width: 320px;
    font-size: 16px;
    padding: 12px 20px 12px 15px;
    border: 1px solid #ddd;
    border-radius : 15px 15px 0px 0px;
  }

    #mylist3 {
    background-position: 10px 10px;
    background-repeat: no-repeat;
    font-size: 16px;
    width: 320px;
    padding: 12px 20px 12px 15px;
    border: 1px solid #ddd;
    margin-left:50px;
    border-radius : 15px 15px 0px 0px;
    width: unset;
  }



  .ms-rtestate-field h1, h1.ms-rteElement-H1, .ms-rtestate-field h2, h2.ms-rteElement-H2 {
    line-height: 1.4;
    color: #000;
}

option:empty
{
 display:none;
}

.ms-core-pageTitle 
{
      font-size: 2.77em;
      white-space: nowrap;
      display: none;
}



.ms-quicklaunchouter.ms-core-sideNavBox-removeLeftMargin {
    display: none;
}

path.highcharts-button-symbol {
    display: none;
}


div#sideNavBox {
    font-size: 13px;
}






#overlay {
  background: #ffffff;
  color: red;
  position: fixed;
  height: 100%;
  width: 100%;
  z-index: 5000;
  top: 0;
  left: 0;
  float: left;
  text-align: center;
  padding-top: 25%;
  opacity: .80;
}
.spinner {
    margin: 0 auto;
    height: 64px;
    width: 64px;
    animation: rotate 0.8s infinite linear;
    border: 5px solid #0072c6;
    border-right-color: transparent;
    border-radius: 50%;
}
@keyframes rotate {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
.spinner-border {
  text-align: center;
}












</style>

   </head>
<div id="overlay">
    <div class="spinner"></div>
    <br />
    Please Wait A Moment...
</div>

      <div id="headercolor">
          <div>
            <label class="smallRisks" style="display:none;" id="labelHeader">
              Plan du Portefeuille :&nbsp; 
            </label>
              <label class="smallRisks" id="nomChantier">PLAN STRATÉGIQUE DU PORTEFEUILLE</label>
              <label class="smallRisks" id="nomPortefeuille"></label>
          </div>


            <select class="mdb-select md-form" style="color:black; font-weight:bold;" id="mylist1" onchange="MainFunctionPortfolio();">
                 <option value="Portefeuilles" selected >Portefeuilles</option>
            </select>
           
      
      </div>
        

        <!-- top navigation -->
        
        <!-- /top navigation -->

        <!-- page content -->





        <div class="right_col" role="main">


 <div class="row"  id="detail-generale0" >

              <div class="col-sm-3 " style="max-width:20%">
    <div class="card bg-c-green order-card">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/counter.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Nombre de Portefeuilles</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="NbPortefeuille"></p></div>
    
</div>
       <div class="card-body">
      
        
      </div>
    </div>
  </div>

       <div class="col-sm-3" style="max-width:20%">
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/counter.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Nombre de Programmes</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;'id="NbProgramme"></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>

       <div class="col-sm-3" style="max-width:20%">
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/counter.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Nombre de Projets</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="NbProjet"></p></div>
    
</div>
       <div class="card-body">
      
        
      </div>
    </div>
  </div>
  <div class="col-sm-3" style="max-width:20%">
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/counting.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Nombre de Ressources</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="Nbressourceportefeuille" ></p>

    </div>
     <div class="card-body">
      
        
      </div>
</div>
      
    </div>
  </div>

            <div class="col-sm-3 " style="max-width:20%">
    <div class="card bg-c-green order-card">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/budget.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Côut du Portefeuille</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="prcost"></p></div>

</div>
       <div class="card-body">
      
        
      </div>
    </div>
  </div>
                    </div>

</div>

<div class="row" id="detail-generale1" >


  <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/budget.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Coût consommée</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="sommeCoutReel" style="margin-left:60px;"></p></div>
        

</div>

      <div class="card-body">
             
      </div>
    </div>
  </div>



    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
<span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/budget.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Coût restant</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="couRestantPortefeuilleProProj" style="margin-left:60px;" ></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>



    
 <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/analytics.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Coût de variance</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="cvariance" style="margin-left:60px;"></p></div>
    


</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>



    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
<span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/calendar.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Travail du portefeuille</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="prwork" style="margin-left:60px;" ></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>

      <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
<span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/calendar.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Travail actuel du portefeuille</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="prActualwork" style="margin-left:60px;" ></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>




    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
<span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/calendar.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Variance de travail</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="wrvariance" style="margin-left:60px;" ></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>




    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
<span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/flow-chart.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Glissement</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="glissementportefeuille" style="margin-left:60px;"  ></p></div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>
   <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/bar-chart.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">% Achévement</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="AchevementTotal" style="padding-bottom:0.6px"></p>

    </div>
     
</div>
      
    </div>
  </div>

                    </div>


   
<div class="row" style="display:none;" id="chantier-details4" >
<figure class="highcharts-figure">
    <div id="container"></div>
    
</figure>

</div>

    </div>


























<div id="chantier-details5" style="display:none;">
  <div id="headercolor1">
          <div>
            <label class="smallRisks1">
               Programme :&nbsp;
            </label>
              <label class="smallRisks1" id="nomProgram"></label>
          </div>
            <select class=" mdb-select md-form" style="color:black; font-weight:bold;" id="mylist2" onchange="mainProgrammeFilter();">
                 <option value="" selected disabled>Programme</option>
            </select>
      </div>

</div>



 <div class="row" style="display:none;" id="programme-details1" >

              <div class="col-sm-3 " >
    <div class="card  ">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/budget.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Nombre de projet</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="nbProjetProg"></p>
    </div>
    
</div>
      <div class="card-body" >
     
        
      </div>
    </div>
  </div>


    <div class="col-sm-3 " >
    <div class="card  ">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/monitoring.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Côut du programme</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="CostProgramProj"></p>
    </div>
    
</div>
      <div class="card-body" >
     
        
      </div>
    </div>
  </div>

  <div class="col-sm-3 " >
    <div class="card  ">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/monitoring.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Coût consommée</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="CostProgramProjConsomme"></p>
    </div>
    
</div>
      <div class="card-body" >
     
        
      </div>
    </div>
  </div>

  <div class="col-sm-3 " >
    <div class="card  ">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/monitoring.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Coût restant</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="CostProgramProjRest"></p>
    </div>
    
</div>
      <div class="card-body" >
     
        
      </div>
    </div>
  </div>

  <div class="col-sm-3 " >
    <div class="card  ">
    <div class="card-header ">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/monitoring.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title" >Coût de variance</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="CostVarProgProj"></p>
    </div>
    
</div>
      <div class="card-body" >
     
        
      </div>
    </div>
  </div>





       <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/calendar.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Date début du programme</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;'id="debutProgProj" style="margin-left:40px;"></p>
    </div>
    
</div>
      <div class="card-body">
     
        
      </div>
    </div>
  </div>


       <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/calendar.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Date fin du programme</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="finProgProj" style="margin-left:40px;"></p>
    </div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>

  <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/back-in-time.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Durée (j)</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="dureeProgProj"></p>
    </div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>


    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/back-in-time.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Travail actuel du programme</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="TravailActualProgProj"></p>
    </div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>

    <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/back-in-time.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Variance de travail</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="varianceTravailProgProj"></p>
    </div>
    
</div>
      <div class="card-body">
      
        
      </div>
    </div>
  </div>



                 <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/bar-chart.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">% Achévement</h4>
    <p class="card-text" style='font-size: 15px; font-weight: bold;' id="achevementProgProj" style="padding-bottom:0.6px"></p>
    </div>
    
</div>
    
    </div>
  </div>

 

  <div class="col-sm-3" >
    <div class="card  ">
    <div class="card-header">
    <div class="col-sm-3">
    <span class="card-widget__icon"><img src='/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/img/flow-chart.png' class='img-rounded' alt='Cinque Terre' width='50px' height='50px'></span>
      </div>
    <div class="col"><h4 class="card-title">Glissement</h4>
     <p class="card-text" style='font-size: 15px; font-weight: bold;' id="glissementprogProj"></p>
    </div>
    
</div>
      <div class="card-body">
     
        
      </div>
    </div>
  </div>



<div class="row"  id="chantier-details6" >
<figure class="highcharts-figure">
    <div id="container1"></div>
    
</figure>

</div>

        

<div class="row"  id="programme-details4" style="display:none;">
<div class="col-xs-12">
            <h4 id="ertabtit" style="color: black"><b>Détails des projets</b></h4>
            <div class="form-group" style="    float: right;">
                                <!--        Show Numbers Of Rows        -->
                                <select class="form-control" name="state" id="maxRows">
                                    <option value="5000">Afficher toutes les lignes</option>
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="70">70</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
            <table class="table table-striped  jambo_table bulk_action no-footer-border" id="tableaux">
                <thead>
                    <tr>
                                        <th style="border-radius:10px 0px 0px 0px; width: 25%;">NOM DE PROJET</th>
                                        <th></th>
                                        <th style="width: 15%;">PROGRAMME</th>
                                        <th style="width: 15%;">TYPE DE PROJET</th>
                                        <th style="width: 15%;">PROPRIÉTAIRE DU PROJET</th>
                                        <th style="width: 10%;">DATE DE DÉBUT</th>
                                        <th style="width: 10%;">DATE FIN</th>
                                        <th>COÛT</th>
                                        <th>Coût consommé</th>
                                        <th>Coût restant</th>
                                      <!--  <th style="width: 5%;">COÛT SANTÉ</th>
                                        <th style="width: 6%;">TRAVAIL SANTÉ</th>
                                        <th style="width: 5%;">SANTÉ DE CALENDRIER</th>
                                        <th style="width: 7%;">SANTÉ DE PROJET</th> -->
                                        <th style="border-radius:0px 10px 0px 0px; width:10%;">% ACHEVÉ</th>
                                    </tr>
                </thead>
                <tbody></tbody>
            </table>
                <div class='pagination-container'>
                <nav>
                    <ul class="pagination">

                        <li data-page="prev">
                            <span>
                                <a href="#" class="previous round" style="color:white;">&#8249;</a> <span
                                    class="sr-only" style="color:white;">(current)
                                </span></span>
                        </li>
                        <!-- Here the JS Function Will Add the Rows -->
                        <li data-page="next" id="prev">
                            <span> <a href="#" class="next round" style="color:white;">&#8250;</a> <span class="sr-only"
                                    style="color:white;">(current)</span></span>
                        </li>
                    </ul>
                </nav>
                </div>
        </div>
</div>










<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/MainFilterJs.js"></script>
<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/FilterPortfolio.js"></script>

<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/jquery3.4.1.js"></script>
<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/jquery.dataTables.min.js"></script>

<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/dataTables.bootstrap4.min.js"></script>
<script type="text/javascript" src="https://momentjs.com/downloads/moment-with-locales.js"></script> 
   <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/Chart.min.js"></script>
   <script src="https://cdn.jsdelivr.net/gh/emn178/chartjs-plugin-labels/src/chartjs-plugin-labels.js"></script>
   
     <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/custom.min.js"></script>
     
 <script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/highcharts.js"></script>
<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/timeline.js"></script>
<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/exporting.js"></script>
<script src="/sites/BIAT/_catalogs/masterpage/Dashboard/Strategie/javascript/accessibility.js"></script>




<script type="text/javascript">
//*********************************chantier*******************************

jQuery(document).ready(function() {
    jQuery('#overlay').fadeOut(3000);
});


    function conToMill(num) {
if (num==0)
{
     return Math.abs(num) > 999 ? Math.sign(num)*((Math.abs(num)/1).toFixed(2))  : Math.sign(num)*Math.abs(num)
}
if (num<1000000 && num>999)
{
     return Math.abs(num) > 999 ? Math.sign(num)*((Math.abs(num)/1000).toFixed(2)) + 'K' : Math.sign(num)*Math.abs(num)
}
if (num<-999 && num>-1000000)
{
     return Math.abs(num) > 999 ? Math.sign(num)*((Math.abs(num)/1000).toFixed(2)) + 'K' : Math.sign(num)*Math.abs(num)
}
if (num<0 && num>-1000)
{
     return Math.abs(num) > 999 ? Math.sign(num)*((Math.abs(num)/1).toFixed(2)) : Math.sign(num)*Math.abs(num)
}
if (num>0 && num<1000)
{
     return Math.abs(num) > 999 ? Math.sign(num)*((Math.abs(num)/1).toFixed(2)) : Math.sign(num)*Math.abs(num)
}
if (num>999999)
{
     return Math.abs(num) > 999999 ? Math.sign(num)*((Math.abs(num)/1000000).toFixed(2)) + 'M' : Math.sign(num)*Math.abs(num)
}
if (num<-999999)
{
     return Math.abs(num) > 999999 ? Math.sign(num)*((Math.abs(num)/1000000).toFixed(2)) + 'M' : Math.sign(num)*Math.abs(num)
}

}






function MainDataLoadAllData()
{

var responsePortfolioName = responsePortfolioName ||[];
var urlPortfolio = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectName,ProjectId&$filter=Types_de_Projet eq 'Portefeuille'";

function LoadAllPortfolio() {

            $.ajax({url:  urlPortfolio,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responsePortfolioName = responsePortfolioName.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlPortfolio = data.d.__next;
                                            LoadAllPortfolio();
                                        }          
                          
            $.each(responsePortfolioName, function(key, value) 
            {           
                
                var prog = value.ProjectName;  
                 
                
                  $('#mylist1').append($('<option>',
                           {
                              text : prog,
                              value:prog
                            })); 


                    

                            var opt = {};
                              $("#mylist1 > option").each(function () {
                                if(opt[$(this).text()]) {
                                    $(this).remove();
                                } else {
                                    opt[$(this).text()] = $(this).val();
                                }


                            }); 
                
                       
            });


            
}   
});
}                                  
LoadAllPortfolio();



var responseProjectData = responseProjectData ||[];
var urlProjectData = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectName,Types_de_Projet";

function LoadGeneralData(){

$.ajax({url:  urlProjectData,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responseProjectData = responseProjectData.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlProjectData = data.d.__next;
                                            LoadGeneralData();
                                        }   

                var nbProject = 0;
                var nbProgram = 0;
                var nbPortfolio = 0;
                var costProjet=0;
                var costActual = 0;
                var costRest = 0;

            $.each(responseProjectData, function(key, value) 
            {           
                
                 var projName = value.ProjectName;
                 var typeProj = value.Types_de_Projet;

                 if(typeProj =="Portefeuille")
                 {
                    nbPortfolio++;
                 }

                 if(typeProj =="Programme")
                 {
                    nbProgram++;
                 }

                 if(typeProj =="Page_Maitre")
                 {
                    nbProject++;
                 }
      
           
            });

       
            document.getElementById("NbPortefeuille").innerHTML=nbPortfolio;
            document.getElementById("NbProgramme").innerHTML=nbProgram;
            document.getElementById("NbProjet").innerHTML=nbProject;
            /* document.getElementById("AchevementTotal").innerHTML="<p>"+avg+"% <progress id='' max='100' value='"+avg+"' style='width: 60%; height:10px;  background-color:green;'></progress></p>";
            document.getElementById("DateDebutPortefeuille").innerHTML=StartChant;
            document.getElementById("DateFinPortefeuille").innerHTML=FinishChant;
            document.getElementById("budgetportefeuille").innerHTML=sumbudget;*/
             
           
            
}   
});

}
LoadGeneralData();



var responseProjectDataCost = responseProjectDataCost ||[];
var urlProjectDataCost = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectCost,ProjectActualCost,ProjectCostVariance,ProjectWork,ProjectActualWork,ProjectWorkVariance,ProjectPercentCompleted&$filter=Types_de_Projet eq 'Portefeuille'";

function LoadGeneralDataCost(){

$.ajax({url:  urlProjectDataCost,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responseProjectDataCost = responseProjectDataCost.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlProjectDataCost = data.d.__next;
                                            LoadGeneralDataCost();
                                        }   

                var pourcentageAchev = 0;
                var achevTotal=0;

                var projCost = 0;
                var projcostvariance = 0;
                var projWork = 0;
                var pworkvariance = 0;
                var sommeCoutReel = 0;
                var sommeCoutRestant = 0;
                var ProjectActualWork=0;

            $.each(responseProjectDataCost, function(key, value) 
            {           
                        var achevement = value.ProjectPercentCompleted;
                        var pCost = parseInt(value.ProjectCost);
                        var pcostVar = parseInt(value.ProjectCostVariance);
                        var pwork = parseInt(value.ProjectWork);
                        var pwvariance = parseInt(value.ProjectWorkVariance);
                        var proActualWork = parseInt(value.ProjectActualWork);


                        projCost = projCost + pCost;
                        projcostvariance = projcostvariance + pcostVar;
                        projWork = projWork + pwork;
                        pworkvariance = pworkvariance + pwvariance;
                        ProjectActualWork = ProjectActualWork + proActualWork;

                        var coutReel=parseFloat(value.ProjectActualCost).toFixed(0);
                        //sommeCoutPlan=parseFloat(parseFloat(sommeCoutPlan)+parseFloat(coutPlan)).toFixed(0);
                        sommeCoutReel=parseFloat(parseFloat(sommeCoutReel)+parseFloat(coutReel)).toFixed(0);

                        sommeCoutRestant = parseFloat(projCost).toFixed(0) - parseFloat(sommeCoutReel).toFixed(0);

                        pourcentageAchev = pourcentageAchev + achevement;

                 

      
           
            });
             
            achevTotal = pourcentageAchev/2;

            document.getElementById("AchevementTotal").innerHTML="<p>"+achevTotal+"% <progress id='' max='100' value='"+achevTotal+"' style='width: 60%; height:10px;  background-color:green;'></progress></p>";

                    document.getElementById("prcost").innerHTML = conToMill(projCost);
                    document.getElementById("sommeCoutReel").innerHTML = conToMill(sommeCoutReel);
                    document.getElementById("couRestantPortefeuilleProProj").innerHTML = conToMill(sommeCoutRestant);

                    document.getElementById("cvariance").innerHTML = conToMill(projcostvariance);
                    document.getElementById("prwork").innerHTML = conToMill(projWork);
                    document.getElementById("wrvariance").innerHTML = conToMill(pworkvariance);
                    document.getElementById("prActualwork").innerHTML = conToMill(ProjectActualWork);
           
            
}   
});

}
LoadGeneralDataCost();




var urlNbrResource = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Resources?$select=ResourceName";
var responseNbrResource = responseNbrResource ||[];

function LoadNumberResource()
{
  $.ajax({url:  urlNbrResource,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responseNbrResource = responseNbrResource.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlNbrResource = data.d.__next;
                                            LoadNumberResource();
                                        } 
                  var nomResource="";
                  
                  var TabRess = [];
                  
            $.each(responseNbrResource, function(key, value) 
            { 
               nomResource = value.ResourceName;
               if((nomResource !=null)&&(TabRess.indexOf(nomResource)==-1)&&(nomResource!="Ressource non affectée")&&(nomResource!="Ressource locale générique")&&(nomResource!="Ressource inconnue"))
               {
                TabRess.push(nomResource);
               }



              


            });

            //console.log("Le tableau Resource " + TabRess.join());

            

            document.getElementById('Nbressourceportefeuille').innerHTML = TabRess.length;



}   
});

}
LoadNumberResource();

var urlDateGlissement = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]/Projects?$select=ProjectId,ProjectStartDate,ProjectFinishDate&$filter=Types_de_Projet eq 'Page_Maitre'";
var responseDateGlissement = responseDateGlissement ||[];

function getDateGlissement(){
  $.ajax({url:  urlDateGlissement,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responseDateGlissement = responseDateGlissement.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlDateGlissement = data.d.__next;
                                            getDateGlissement();
                                        } 
                var idProjetG=[];
                var dateDebProjetG=[];
                var dateFinProjetG=[];
                var dateFinRefG=[];
                  
            $.each(responseDateGlissement, function(key, value) 
            { 
              
                var idP=value.ProjectId;
               var projStartDate=value.ProjectStartDate;
               var projfinshtDate=value.ProjectFinishDate;
               if (idProjetG.indexOf(idP)==-1) {
                idProjetG.push(idP);
                dateDebProjetG.push(projStartDate);
                dateFinProjetG.push(projfinshtDate);
                dateFinRefG.push("");
               }
              
               

            });
calculGlissementGlobal(idProjetG,dateDebProjetG,dateFinProjetG,dateFinRefG);


}   
});
}
getDateGlissement();




var urlDateBaseGlissement = _spPageContextInfo.siteAbsoluteUrl + "/_api/ProjectData/[en-US]//ProjectBaselines?$select=ProjectId,ProjectBaselineFinishDate";
var responseBaseDateGlissement = responseBaseDateGlissement ||[];
function calculGlissementGlobal(idProjetG,dateDebProjetG,dateFinProjetG,dateFinRefG){
   $.ajax({url:  urlDateBaseGlissement,          
                                    method: "GET",
                                    dataType: "json",
                                    headers: {Accept: "application/json;odata=verbose"},       
                                    success: function(data) {     
                                    responseBaseDateGlissement = responseBaseDateGlissement.concat(data.d.results);
                                        if (data.d.__next) {
                                            urlDateBaseGlissement = data.d.__next;
                                            calculGlissementGlobal(idProjetG,dateDebProjetG,dateFinProjetG,dateFinRefG);
                                        } 
                                        var durReel=[];
                                        var durRef=[];
                                        var glissArray=[];
                                        var avgGliss=0;
                                        var sumGliss=0;
                  
              
            $.each(responseBaseDateGlissement, function(key, value) 
            { 
              var idProjBaseline=value.ProjectId;
              var finRefProj=value.ProjectBaselineFinishDate;
              for (var i =0; i<idProjetG.length; i++) {
                if (idProjBaseline==idProjetG[i]) {
                  dateFinRefG[i]=finRefProj;
                }

              }

            });
             moment.locale('fr');
            
            
            for (var i = 0; i <dateFinRefG.length; i++) {
              if(dateFinRefG[i]!=""){
                var refFinish=moment(dateFinRefG[i]);
                var dateFin=moment(dateFinProjetG[i]);
                var daetDeb=moment(dateDebProjetG[i]);
                var realDuration=dateFin.diff(daetDeb,'days');
                var baseDuration=refFinish.diff(daetDeb,'days');
                var gliss=0;
                gliss=parseFloat(((realDuration-baseDuration)/realDuration)*100);
                if (gliss<0) {
                  gliss=0;
                }
                //console.log("gliss= "+gliss);
                glissArray.push(gliss);
              }
            }
            //console.log("glissArray= "+glissArray.join());
            for (var i = 0; i < glissArray.length; i++) {
              sumGliss+=parseFloat(glissArray[i])
            }
            //console.log("sumGliss= "+ sumGliss);
            avgGliss=parseFloat(sumGliss/glissArray.length).toFixed(0);
            //console.log("avgGliss= "+avgGliss);
            document.getElementById("glissementportefeuille").innerHTML=avgGliss+"%";
}           
});
}

}MainDataLoadAllData();

</script>